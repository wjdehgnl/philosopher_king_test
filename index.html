<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>성향테스트 - 철인/수호자/시민의눈</title>
    <style>
        /* 기본 설정 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SUIT Variable', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #f5f5f5;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 390px;
            min-height: 844px;
            height: 844px;
            background-color: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .screen {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            position: relative;
        }

        /* 홈 화면 */
        .home-screen {
            display: flex;
        }

        .logo {
            margin-bottom: 40px;
            text-align: center;
        }

        .logo h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #333;
        }

        .logo p {
            font-size: 16px;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .personality-icon {
            width: 200px;
            height: 200px;
            margin: 0 auto 40px;
            background: linear-gradient(45deg, #d30000, #FF3C43, #FF7719);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .personality-icon::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(0,0,0,0.2) 100%);
        }

        .personality-icon-text {
            font-size: 36px;
            font-weight: 900;
            color: white;
            z-index: 1;
        }

        .start-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 300px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .btn-primary {
            background-color: #d30000;
            color: white;
        }

        .btn-primary:hover {
            background-color: #b50000;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: white;
            color: #666;
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background-color: #f8f8f8;
        }

        /* 테스트 화면 */
        .test-screen {
            display: none;
            padding: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: #e0e0e0;
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #d30000, #FF3C43, #FF7719);
            border-radius: 3px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            margin-bottom: 20px;
            font-size: 14px;
            color: #666;
        }

        .question-container {
            text-align: center;
            margin-bottom: 40px;
        }

        .question-number {
            font-size: 14px;
            color: #999;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            line-height: 1.4;
            margin-bottom: 30px;
        }

        .options-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 40px;
        }

        .option-btn {
            width: 40px;
            height: 40px;
            border: 2px solid #e0e0e0;
            border-radius: 50%;
            background-color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
            color: #999;
        }

        .option-btn:hover {
            border-color: #d30000;
            transform: scale(1.05);
        }

        .option-btn.selected {
            background-color: #333;
            border-color: #333;
            color: white;
        }

        .option-labels {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 12px;
            color: #666;
            padding: 0 20px;
        }

        .questions-container {
            max-height: 60vh;
            overflow-y: auto;
            padding: 20px;
            width: 100%;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .questions-container::-webkit-scrollbar {
            display: none;
        }

        .question-item {
            margin-bottom: 50px;
            opacity: 1;
            transition: all 0.5s ease;
        }

        .question-item:last-child {
            margin-bottom: 80px;
        }

        .question-item.answered {
            opacity: 0.6;
        }

        /* 결과 화면 */
        .result-screen {
            display: none;
            padding: 20px;
            text-align: center;
        }

        .result-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }

        .result-subtitle {
            font-size: 18px;
            font-weight: 600;
            color: #d30000;
            margin-bottom: 30px;
        }

        /* 삼각형 차트 */
        .triangle-chart-container {
            width: 320px;
            height: 280px;
            margin: 0 auto 30px;
            position: relative;
        }

        .triangle-chart {
            width: 100%;
            height: 100%;
        }

        .share-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 30px;
        }

        /* 숨김/표시 클래스 */
        .hidden { 
            display: none !important; 
            visibility: hidden;
            opacity: 0;
        }
        .show { 
            display: flex !important; 
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 홈 화면 -->
        <div class="screen home-screen" id="homeScreen">
            <div class="logo">
                <h1>성향테스트</h1>
                <p>나의 성향은 어떨까?<br>철인 · 수호자 · 시민의 눈</p>
            </div>
            
            <div class="personality-icon">
                <div class="personality-icon-text">성향</div>
            </div>
            
            <div class="start-buttons">
                <button class="btn btn-primary" onclick="startTest()">테스트 시작하기</button>
                <button class="btn btn-primary" onclick="showRandomResult()" style="background-color: #FF7719;">결과테스트</button>
                <button class="btn btn-secondary" onclick="shareKakaoTalk()">카카오톡 공유하기</button>
                <button class="btn btn-secondary" onclick="shareLink()">링크 공유하기</button>
            </div>
        </div>

        <!-- 테스트 화면 -->
        <div class="screen test-screen" id="testScreen">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">1 / 36</div>
            
            <div class="questions-container" id="questionsContainer">
                <!-- 질문들이 동적으로 추가됩니다 -->
            </div>
        </div>

        <!-- 결과 화면 -->
        <div class="screen result-screen" id="resultScreen">
            <div class="result-title">당신의 성향은</div>
            <div class="result-subtitle" id="resultSubtitle">철인에 가까운 성향</div>
            
            <div class="triangle-chart-container">
                <svg class="triangle-chart" viewBox="0 0 300 260">
                    <!-- 가장 바깥 삼각형 (72점) - 버전5 크기 -->
                    <polygon points="150,50 81,190 219,190" 
                             fill="none" 
                             stroke="#ddd" 
                             stroke-width="2" 
                             stroke-dasharray="5,5"/>
                    
                    <!-- 3번째 삼각형 (52점) - 버전5 크기 -->
                    <polygon points="150,73 104,173 196,173" 
                             fill="none" 
                             stroke="#ddd" 
                             stroke-width="1.5" 
                             stroke-dasharray="4,4"/>
                    
                    <!-- 2번째 삼각형 (32점) - 버전5 크기 -->
                    <polygon points="150,96 127,156 173,156" 
                             fill="none" 
                             stroke="#ddd" 
                             stroke-width="1.5" 
                             stroke-dasharray="3,3"/>
                    
                    <!-- 가장 작은 삼각형 (12점) - 이등변삼각형, 32점 비율 참고 -->
                    <polygon points="150,119 142,139 158,139" 
                             fill="none" 
                             stroke="#ddd" 
                             stroke-width="1" 
                             stroke-dasharray="2,2"/>
                    
                    <!-- 결과 삼각형 -->
                    <polygon id="resultTriangle" 
                             points="150,130 150,130 150,130" 
                             fill="rgba(211, 0, 0, 0.3)" 
                             stroke="none"/>
                    
                    <!-- 꼭짓점 라벨 -->
                    <text x="150" y="40" text-anchor="middle" font-size="16" font-weight="bold" fill="#333">철인</text>
                    <text x="65" y="210" text-anchor="middle" font-size="16" font-weight="bold" fill="#333">수호자</text>
                    <text x="235" y="210" text-anchor="middle" font-size="16" font-weight="bold" fill="#333">시민의 눈</text>
                    
                    <!-- 중앙 점 (12점) -->
                    <circle cx="150" cy="130" r="2" fill="#999"/>
                </svg>
            </div>
            
            <div class="share-buttons">
                <button class="btn btn-primary" onclick="restartTest()">다시 테스트하기</button>
                <button class="btn btn-secondary" onclick="shareKakaoTalk()">카카오톡 공유하기</button>
                <button class="btn btn-secondary" onclick="shareLink()">링크 공유하기</button>
            </div>
        </div>
    </div>

    <script>
        // 테스트 설정 - 새로운 3개 지수 체계 (240문항 중 일부만 표시)
        const testConfig = {
            questions: [
                // 철인지수 (indexType: 0) - 도덕심 파트 샘플
                { text: "선배의 잘못을 보고도 침묵하며 넘어가는 것이 현명하다고 생각한다.", indexType: 0, partIndex: 0, isReverse: true },
                { text: "내가 하는 일에서 신념과 원칙은 타협할 수 없는 부분이다.", indexType: 0, partIndex: 0, isReverse: false },
                { text: "법적으로는 문제가 없어도 도덕적으로 옳지 않다면 하지 않는다.", indexType: 0, partIndex: 0, isReverse: false },
                { text: "다수를 위해서는 소수의 희생이 불가피한 경우가 있다고 생각한다.", indexType: 0, partIndex: 0, isReverse: true },
                { text: "올바른 일이라고 판단되면 혼자서라도 행동에 나선다.", indexType: 0, partIndex: 0, isReverse: false },
                
                // 철인지수 - 적시판단 파트 샘플  
                { text: "상황에 따라 융통성 있게 행동하는 것이 중요하다.", indexType: 0, partIndex: 1, isReverse: true },
                { text: "매사에 신중하게 고민하고 결정하는 편이다.", indexType: 0, partIndex: 1, isReverse: false },
                { text: "복잡한 상황에서는 빠른 결정보다는 충분한 검토가 필요하다.", indexType: 0, partIndex: 1, isReverse: true },
                { text: "위기상황에서는 직감적 판단이 더 효과적이다.", indexType: 0, partIndex: 1, isReverse: true },
                { text: "새로운 정보가 생기면 기존 판단을 번복할 수 있다.", indexType: 0, partIndex: 1, isReverse: false },
                
                // 철인지수 - 호불호범위 파트 샘플
                { text: "나는 호불호가 분명한 편이다.", indexType: 0, partIndex: 2, isReverse: true },
                { text: "내 취향과 다른 것들도 인정하고 받아들인다.", indexType: 0, partIndex: 2, isReverse: false },
                { text: "좋아하는 것과 싫어하는 것의 구분이 명확하다.", indexType: 0, partIndex: 2, isReverse: true },
                { text: "다른 사람의 취향을 존중하려고 노력한다.", indexType: 0, partIndex: 2, isReverse: false },
                { text: "내가 싫어하는 것은 분명히 표현한다.", indexType: 0, partIndex: 2, isReverse: true },
                
                // 철인지수 - K-리더십 파트 샘플
                { text: "그룹에서 자연스럽게 리더 역할을 맡게 된다.", indexType: 0, partIndex: 3, isReverse: false },
                { text: "다른 사람들의 의견을 먼저 들어보는 편이다.", indexType: 0, partIndex: 3, isReverse: true },
                { text: "내가 앞장서서 일을 추진하는 것을 좋아한다.", indexType: 0, partIndex: 3, isReverse: false },
                { text: "팀워크를 중시하고 협력을 이끌어낸다.", indexType: 0, partIndex: 3, isReverse: false },
                { text: "결정권이 있을 때 책임감을 느끼고 신중하게 결정한다.", indexType: 0, partIndex: 3, isReverse: false },

                // 수호자지수 (indexType: 1) - 충성 파트 샘플
                { text: "국가는 개인의 자유를 제한할 수 있다.", indexType: 1, partIndex: 0, isReverse: false },
                { text: "상관의 명령은 불합리해도 따라야 한다.", indexType: 1, partIndex: 0, isReverse: true },
                { text: "조직의 결정을 따르는 것이 중요하다.", indexType: 1, partIndex: 0, isReverse: true },
                { text: "나는 공동체의 규율을 충실히 지킨다.", indexType: 1, partIndex: 0, isReverse: false },
                { text: "지도자에 대한 충성심이 공동체를 지탱한다.", indexType: 1, partIndex: 0, isReverse: false },
                
                // 수호자지수 - 질서 파트 샘플
                { text: "법과 규칙은 엄격히 지켜져야 한다.", indexType: 1, partIndex: 1, isReverse: false },
                { text: "질서를 어지럽히는 행위는 제재해야 한다.", indexType: 1, partIndex: 1, isReverse: true },
                { text: "규율 없는 자유는 혼란을 낳는다.", indexType: 1, partIndex: 1, isReverse: false },
                { text: "법은 개인보다 우선한다.", indexType: 1, partIndex: 1, isReverse: true },
                { text: "무질서는 공동체를 붕괴시킨다.", indexType: 1, partIndex: 1, isReverse: false },
                
                // 수호자지수 - 책임 파트 샘플
                { text: "공동체의 이익을 위해 개인적 욕구를 희생할 수 있다.", indexType: 1, partIndex: 2, isReverse: false },
                { text: "책임은 피하지 않고 감당해야 한다.", indexType: 1, partIndex: 2, isReverse: false },
                { text: "내가 맡은 역할을 끝까지 수행한다.", indexType: 1, partIndex: 2, isReverse: true },
                { text: "나는 임무에 책임감을 느낀다.", indexType: 1, partIndex: 2, isReverse: false },
                { text: "공동체의 성공은 모두의 책임이다.", indexType: 1, partIndex: 2, isReverse: false },
                
                // 수호자지수 - 보호 파트 샘플
                { text: "공동체를 지키는 것이 개인보다 우선이다.", indexType: 1, partIndex: 3, isReverse: false },
                { text: "나는 위협이 있으면 공동체를 보호한다.", indexType: 1, partIndex: 3, isReverse: true },
                { text: "외부의 위험으로부터 방어가 필요하다.", indexType: 1, partIndex: 3, isReverse: false },
                { text: "나는 위기에 공동체를 위해 싸운다.", indexType: 1, partIndex: 3, isReverse: true },
                { text: "안전을 위해 희생할 준비가 되어 있다.", indexType: 1, partIndex: 3, isReverse: false },

                // 시민의 눈지수 (indexType: 2) - 감시 파트 샘플
                { text: "권력자는 항상 감시받아야 한다.", indexType: 2, partIndex: 0, isReverse: false },
                { text: "언론의 자유로운 감시는 민주주의의 핵심이다.", indexType: 2, partIndex: 0, isReverse: false },
                { text: "권력자는 시민의 눈을 두려워해야 한다.", indexType: 2, partIndex: 0, isReverse: false },
                { text: "나는 지도자의 행동을 비판적으로 본다.", indexType: 2, partIndex: 0, isReverse: false },
                { text: "감시 없이는 부패가 생긴다.", indexType: 2, partIndex: 0, isReverse: false },
                
                // 시민의 눈지수 - 참여 파트 샘플
                { text: "시민은 정치 과정에 적극 참여해야 한다.", indexType: 2, partIndex: 1, isReverse: false },
                { text: "투표는 최소한의 참여다.", indexType: 2, partIndex: 1, isReverse: true },
                { text: "사회문제 참여는 중요하다.", indexType: 2, partIndex: 1, isReverse: false },
                { text: "참여 없이는 정치가 변하지 않는다.", indexType: 2, partIndex: 1, isReverse: false },
                { text: "참여는 책임 있는 시민의 자세다.", indexType: 2, partIndex: 1, isReverse: false },
                
                // 시민의 눈지수 - 비판 파트 샘플
                { text: "나는 권력자의 정책을 비판적으로 본다.", indexType: 2, partIndex: 2, isReverse: false },
                { text: "비판은 민주주의를 지탱한다.", indexType: 2, partIndex: 2, isReverse: false },
                { text: "비판 없는 사회는 발전할 수 없다.", indexType: 2, partIndex: 2, isReverse: true },
                { text: "나는 잘못된 정책을 비판한다.", indexType: 2, partIndex: 2, isReverse: false },
                { text: "비판은 책임을 묻는 과정이다.", indexType: 2, partIndex: 2, isReverse: false },
                
                // 시민의 눈지수 - 다양성존중 파트 샘플
                { text: "다양한 의견은 존중되어야 한다.", indexType: 2, partIndex: 3, isReverse: false },
                { text: "나는 다른 문화와 가치를 존중한다.", indexType: 2, partIndex: 3, isReverse: false },
                { text: "사회는 다양성을 통해 발전한다.", indexType: 2, partIndex: 3, isReverse: false },
                { text: "나는 나와 다른 의견을 수용한다.", indexType: 2, partIndex: 3, isReverse: false },
                { text: "다양성은 민주주의의 힘이다.", indexType: 2, partIndex: 3, isReverse: false }
            ],
            
            indices: [
                { 
                    name: "철인지수", 
                    parts: ["도덕심", "적시판단", "호불호범위", "K-리더십"] 
                },
                { 
                    name: "수호자지수", 
                    parts: ["충성", "질서", "책임", "보호"] 
                },
                { 
                    name: "시민의 눈지수", 
                    parts: ["감시", "참여", "비판", "다양성존중"] 
                }
            ]
        };

        // 질문을 간단한 알고리즘으로 섞기
        function shuffleQuestions(questions) {
            const shuffled = [...questions];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // 각 지수별로 파트당 3문항씩 선택하여 총 36개 질문 구성
        function selectQuestionsForTest() {
            const selectedQuestions = [];
            
            // 3개 지수(indexType: 0,1,2) × 4개 파트 × 3문항씩 = 36문항
            for (let indexType = 0; indexType < 3; indexType++) {
                for (let partIndex = 0; partIndex < 4; partIndex++) {
                    // 해당 지수의 해당 파트 문항들 필터링
                    const partQuestions = testConfig.questions.filter(q => 
                        q.indexType === indexType && q.partIndex === partIndex
                    );
                    
                    // 파트별 문항들 섞기 후 3개 선택
                    const shuffledPart = shuffleQuestions(partQuestions);
                    const selectedPart = shuffledPart.slice(0, 3);
                    
                    selectedQuestions.push(...selectedPart);
                }
            }
            
            // 선택된 36개 질문을 다시 완전 랜덤으로 섞기
            return shuffleQuestions(selectedQuestions);
        }

        // 테스트용 질문 리스트 생성
        let testQuestions = selectQuestionsForTest();

        // 테스트 상태
        let currentQuestion = 0;
        let answers = [];
        let scores = [0, 0, 0]; // 3개 지수별 점수 (철인, 수호자, 시민의눈)

        // 화면 전환 유틸리티 함수
        function switchScreen(targetScreenId) {
            const allScreens = ['homeScreen', 'testScreen', 'resultScreen'];
            
            allScreens.forEach(screenId => {
                const screen = document.getElementById(screenId);
                screen.classList.remove('show');
                screen.classList.add('hidden');
            });
            
            const targetScreen = document.getElementById(targetScreenId);
            targetScreen.classList.remove('hidden');
            targetScreen.classList.add('show');
            
            // 스크롤 위치 초기화
            window.scrollTo(0, 0);
            document.documentElement.scrollTop = 0;
            document.body.scrollTop = 0;
            
            const questionsContainer = document.getElementById('questionsContainer');
            if (questionsContainer) {
                questionsContainer.scrollTop = 0;
            }
        }

        // 개발용 테스트 기능
        function showRandomResult() {
            // 랜덤한 점수 생성 (12~72 범위)
            scores = [
                Math.floor(Math.random() * 61) + 12, // 철인지수
                Math.floor(Math.random() * 61) + 12, // 수호자지수
                Math.floor(Math.random() * 61) + 12  // 시민의눈지수
            ];
            
            switchScreen('resultScreen');
            
            // 가장 높은 점수의 지수 찾기
            const maxScore = Math.max(...scores);
            const maxIndex = scores.indexOf(maxScore);
            const resultTypes = ['철인', '수호자', '시민의 눈'];
            
            document.getElementById('resultSubtitle').textContent = 
                `${resultTypes[maxIndex]}에 가까운 성향`;

            // 삼각형 그리기 (간단화된 좌표 사용)
            const trianglePoints = calculateTrianglePoints(scores);
            
            setTimeout(() => {
                document.getElementById('resultTriangle').setAttribute('points', trianglePoints);
            }, 500);
        }

        function startTest() {
            switchScreen('testScreen');
            showNextQuestion();
        }

        function showNextQuestion() {
            if (currentQuestion >= testQuestions.length) {
                showResult();
                return;
            }

            const question = testQuestions[currentQuestion];
            const questionsContainer = document.getElementById('questionsContainer');
            
            const questionItem = document.createElement('div');
            questionItem.className = 'question-item';
            questionItem.innerHTML = `
                <div class="question-container">
                    <div class="question-number">질문 ${currentQuestion + 1}</div>
                    <div class="question-text">${question.text}</div>
                </div>
                
                <div class="option-labels">
                    <span>매우 반대</span>
                    <span>매우 동의</span>
                </div>
                <div class="options-container">
                    <button class="option-btn" data-value="1" data-question="${currentQuestion}">1</button>
                    <button class="option-btn" data-value="2" data-question="${currentQuestion}">2</button>
                    <button class="option-btn" data-value="3" data-question="${currentQuestion}">3</button>
                    <button class="option-btn" data-value="4" data-question="${currentQuestion}">4</button>
                    <button class="option-btn" data-value="5" data-question="${currentQuestion}">5</button>
                    <button class="option-btn" data-value="6" data-question="${currentQuestion}">6</button>
                </div>
            `;
            
            questionsContainer.appendChild(questionItem);
            
            const options = questionItem.querySelectorAll('.option-btn');
            options.forEach(btn => {
                btn.onclick = () => selectOption(btn);
            });

            document.getElementById('progressText').textContent = `${currentQuestion + 1} / 36`;
            document.getElementById('progressFill').style.width = `${((currentQuestion + 1) / 36) * 100}%`;
            
            setTimeout(() => {
                questionItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        function selectOption(selectedBtn) {
            const questionIndex = parseInt(selectedBtn.dataset.question);
            const value = parseInt(selectedBtn.dataset.value);
            
            const questionItem = selectedBtn.closest('.question-item');
            const allOptions = questionItem.querySelectorAll('.option-btn');
            
            allOptions.forEach(btn => {
                btn.classList.remove('selected');
                btn.style.pointerEvents = 'none';
            });
            
            selectedBtn.classList.add('selected');
            questionItem.classList.add('answered');
            
            answers[questionIndex] = value;
            
            // 새로운 점수 계산 로직
            const question = testQuestions[questionIndex];
            const actualScore = question.isReverse ? (7 - value) : value;
            scores[question.indexType] += actualScore;
            
            currentQuestion++;
            
            setTimeout(() => {
                showNextQuestion();
            }, 100);
        }

        // 점수를 기준선에 맞춰 간단화하는 함수
        function simplifyScore(score) {
            if (score <= 21) return 12;      // 12-21 → 12점 삼각형
            else if (score <= 41) return 32; // 22-41 → 32점 삼각형
            else if (score <= 61) return 52; // 42-61 → 52점 삼각형
            else return 72;                   // 62-72 → 72점 삼각형
        }

        // 삼각형 좌표 계산 함수 (버전5 크기, 12점만 이등변삼각형)
        function calculateTrianglePoints(scores) {
            // 점수를 간단화
            const simplifiedScores = scores.map(simplifyScore);
            
            // 버전5 크기 + 12점 이등변삼각형 좌표
            const trianglePoints = {
                12: { philosopher: {x: 150, y: 119}, guardian: {x: 142, y: 139}, citizen: {x: 158, y: 139} },
                32: { philosopher: {x: 150, y: 96}, guardian: {x: 127, y: 156}, citizen: {x: 173, y: 156} },
                52: { philosopher: {x: 150, y: 73}, guardian: {x: 104, y: 173}, citizen: {x: 196, y: 173} },
                72: { philosopher: {x: 150, y: 50}, guardian: {x: 81, y: 190}, citizen: {x: 219, y: 190} }
            };
            
            // 각 꼭짓점 좌표 계산
            const philosopher = trianglePoints[simplifiedScores[0]].philosopher;
            const guardian = trianglePoints[simplifiedScores[1]].guardian;
            const citizen = trianglePoints[simplifiedScores[2]].citizen;
            
            return `${philosopher.x},${philosopher.y} ${guardian.x},${guardian.y} ${citizen.x},${citizen.y}`;
        }

        function showResult() {
            switchScreen('resultScreen');

            // 가장 높은 점수의 지수 찾기
            const maxScore = Math.max(...scores);
            const maxIndex = scores.indexOf(maxScore);
            const resultTypes = ['철인', '수호자', '시민의 눈'];
            
            document.getElementById('resultSubtitle').textContent = 
                `${resultTypes[maxIndex]}에 가까운 성향`;

            // 삼각형 그리기 (간단화된 좌표 사용)
            const trianglePoints = calculateTrianglePoints(scores);
            
            setTimeout(() => {
                document.getElementById('resultTriangle').setAttribute('points', trianglePoints);
            }, 500);
        }

        function restartTest() {
            currentQuestion = 0;
            answers = [];
            scores = [0, 0, 0];
            testQuestions = selectQuestionsForTest();
            
            document.getElementById('questionsContainer').innerHTML = '';
            document.getElementById('progressText').textContent = '1 / 36';
            document.getElementById('progressFill').style.width = '0%';
            
            switchScreen('homeScreen');
        }

        function shareKakaoTalk() {
            const resultTypes = ['철인', '수호자', '시민의 눈'];
            const maxIndex = scores.indexOf(Math.max(...scores));
            alert(`카카오톡 공유 기능 (결과: ${resultTypes[maxIndex]})\n실제 구현 시 카카오 SDK를 사용하세요.`);
        }

        function shareLink() {
            if (navigator.share) {
                navigator.share({
                    title: '성향테스트 - 철인/수호자/시민의눈',
                    text: '나의 성향을 확인해보세요!',
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(window.location.href).then(() => {
                    alert('링크가 복사되었습니다!');
                });
            }
        }
    </script>
</body>
</html>
